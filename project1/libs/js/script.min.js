$(window).on("load",function(){$("#preloader").length&&$("#preloader").delay(100).fadeOut("slow",function(){$(this).remove()})}),$(document).ready(function(){$("#selectCountry").append("<option> Select a country </option>"),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(t){let a,e;null!==t.coords.latitude&&null!==t.coords.longitude?(a=t.coords.latitude,e=t.coords.longitude):(a=51.509865,e=-.118092);let o=L.map("map").setView([a,e],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(o);let n,s=L.icon({iconUrl:"https://shomadutt.com/project1/libs/Leaflet/images/globe.png",shadowUrl:"https://shomadutt.com/project1/libs/Leaflet/images/globeShadow.png",iconSize:[60,95],shadowSize:[50,64],iconAnchor:[22,94],shadowAnchor:[4,62],popupAnchor:[-3,-76]}),r=L.marker([a,e],{icon:s}).bindPopup("Your location").addTo(o);$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(a){if(JSON.stringify(a),"ok"==a.status.name)for(let e=0;e<a.data.length;e++)a.data[e].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()&&(n=L.geoJson(a.data[e].geometry))}})}}),$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(a){if(JSON.stringify(a),"ok"==a.status.name)for(let e=0;e<a.data.length;e++)if(a.data[e].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()){let t=L.markerClusterGroup();t.addLayer(L.marker([51.510357,-.116773],{icon:s}).bindPopup("Big Ben")),t.addLayer(L.marker([51.503399,-.119519],{icon:s}).bindPopup("London Eye")),t.addLayer(L.marker([51.502777,-.15125],{icon:s}).bindPopup("Hyde Park Corner")),t.addLayer(L.marker([51.501476,-.140634],{icon:s}).bindPopup("Buckingham Palace")),t.addLayer(L.marker([51.4967,-.1764],{icon:s}).bindPopup("Natural History Museum")),t.addLayer(L.marker([51.49829,-.13153],{icon:s}).bindPopup("Westminster Abbey")),t.addLayer(L.marker([51.51218,-.09199],{icon:s}).bindPopup("Tower Of London")),t.addLayer(L.marker([51.496639,-.17218],{icon:s}).bindPopup("Victoria And Albert Museum")),t.addLayer(L.marker([51.508972,-.128794],{icon:s}).bindPopup("National Gallery")),t.addLayer(L.marker([51.518757,-.126168],{icon:s}).bindPopup("British Museum")),o.addLayer(t)}}})}}),$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let p=0;p<s.data.length;p++)if(s.data[p].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()){function d(){let d,i=L.popup().setLatLng([a,e]).setContent("House number: "+t.data.results[0].components.house_number+"<br>Post code: "+t.data.results[0].components.postcode+"<br>Road: "+t.data.results[0].components.road+"<br>State: "+t.data.results[0].components.state+"<br>State code: "+t.data.results[0].components.state_code+"<br>State district: "+t.data.results[0].components.state_district+"<br>Suburb: "+t.data.results[0].components.suburb+"<br>Capital: "+t.data.results[0].components.city+"<br>City district: "+t.data.results[0].components.city_district+"<br>Continent: "+t.data.results[0].components.continent+"<br>Country: "+t.data.results[0].components.country+"<br>Country code: "+t.data.results[0].components.country_code);L.easyButton("fa-globe",function(t,o){o.removeLayer(n),n=L.geoJson(s.data[p].geometry),n.addTo(o),o.fitBounds(n.getBounds()),o.removeLayer(r)&&o.addLayer(r),d=t,d.button.style.backgroundColor="#007bff",i.setLatLng([a,e]).openOn(o)}).addTo(o)}d()}}})}}),$("#userAddress").click(function(){$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let d=0;d<s.data.length;d++)if(s.data[d].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()){o.removeLayer(n),o.setView([a,e],13),o.removeLayer(r)&&o.addLayer(r);L.popup().setLatLng([a,e]).setContent("House number: "+t.data.results[0].components.house_number+"<br>Post code: "+t.data.results[0].components.postcode+"<br>Road: "+t.data.results[0].components.road+"<br>State: "+t.data.results[0].components.state+"<br>State code: "+t.data.results[0].components.state_code+"<br>State district: "+t.data.results[0].components.state_district+"<br>Suburb: "+t.data.results[0].components.suburb+"<br>Capital: "+t.data.results[0].components.city+"<br>City district: "+t.data.results[0].components.city_district+"<br>Continent: "+t.data.results[0].components.continent+"<br>Country: "+t.data.results[0].components.country+"<br>Country code: "+t.data.results[0].components.country_code).openOn(o)}}})},error:function(t,a,e){}})}),$("#userWeather").click(function(){$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let d=0;d<s.data.length;d++)s.data[d].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()&&(o.removeLayer(n),o.setView([a,e],13),o.removeLayer(r)&&o.addLayer(r),$.ajax({url:"libs/php/getOpenWeather.php",type:"POST",dataType:"json",data:{lon:e,lat:a},success:function(t){if("ok"==t.status.name){L.popup().setLatLng([a,e]).setContent("Weather description: "+t.data.weather[0].description+"<br>Temperature: "+t.data.main.temp+"<br>Feels like: "+t.data.main.feels_like+"<br>Minimum temperature: "+t.data.main.temp_min+"<br>Maximum temperature: "+t.data.main.temp_max+"<br>Pressure: "+t.data.main.pressure+"<br>Humidity: "+t.data.main.humidity+"<br>Visibility: "+t.data.visibility+"<br>Wind speed: "+t.data.wind.speed+"<br>Wind temperature: "+t.data.wind.deg+"<br>Clouds: "+t.data.clouds.all+"<br>Sunrise: "+t.data.sys.sunrise+"<br>Sunset: "+t.data.sys.sunset+"<br>Timezone: "+t.data.timezone).openOn(o)}},error:function(t,a,e){}}))}})},error:function(t,a,e){}})}),$("#userWiki").click(function(){$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let d=0;d<s.data.length;d++)s.data[d].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()&&(o.removeLayer(n),o.setView([a,e],13),o.removeLayer(r)&&o.addLayer(r),$.ajax({url:"libs/php/getGeonamesWiki.php",type:"POST",dataType:"json",data:{lat:a,lng:e},success:function(t){if("ok"==t.status.name){L.popup().setLatLng([a,e]).setContent("Wikipedia summary: "+t.data[0].summary+"<br>Wikipedia URL: "+t.data[0].wikipediaUrl+"<br>Distance: "+t.data[0].distance).openOn(o)}},error:function(t,a,e){}}))}})},error:function(t,a,e){}})}),$("#userCountryInfo").click(function(){$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let d=0;d<s.data.length;d++)s.data[d].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()&&(o.removeLayer(n),o.setView([a,e],13),o.removeLayer(r)&&o.addLayer(r),$.ajax({url:"libs/php/getCountryInfo.php",type:"POST",dataType:"json",data:{countryCode:t.data.results[0].components.country_code},success:function(t){if("ok"==t.status.name){L.popup().setLatLng([a,e]).setContent("Continent: "+t.data[0].continent+"<br>Continent Name: "+t.data[0].continentName+"<br>Capital: "+t.data[0].capital+"<br>Area in sq km: "+t.data[0].areaInSqKm+"<br>Population: "+t.data[0].population+"<br>Currency code: "+t.data[0].currencyCode+"<br>Languages: "+t.data[0].languages).openOn(o)}},error:function(t,a,e){}}))}})},error:function(t,a,e){}})}),$("#userHoliday").click(function(){$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let d=0;d<s.data.length;d++)s.data[d].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()&&(o.removeLayer(n),o.setView([a,e],13),o.removeLayer(r)&&o.addLayer(r),$.ajax({url:"libs/php/getHolidayInfo.php",type:"POST",dataType:"json",data:{countryCode:t.data.results[0].components.country_code},success:function(t){if("ok"==t.status.name){function n(){let a=[];for(let e=0;e<t.data.length;e++){let o=t.data[e].date+" "+t.data[e].localName;a.push(o)}return a}let s=n().join(" <br>");L.popup().setLatLng([a,e]).setContent(s).openOn(o)}},error:function(t,a,e){}}))}})},error:function(t,a,e){}})}),$("#userIncome").click(function(){$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let d=0;d<s.data.length;d++)s.data[d].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()&&(o.removeLayer(n),o.setView([a,e],13),o.removeLayer(r)&&o.addLayer(r),$.ajax({url:"libs/php/getIncomeInfo.php",type:"POST",dataType:"json",data:{countryCode:t.data.results[0].components.country_code},success:function(t){if("ok"==t.status.name){L.popup().setLatLng([a,e]).setContent("Income level: "+t.data[1][0].incomeLevel.value).openOn(o)}},error:function(t,a,e){}}))}})},error:function(t,a,e){}})}),$("#userFlag").click(function(){$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let d=0;d<s.data.length;d++)s.data[d].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()&&(o.removeLayer(n),o.setView([a,e],13),o.removeLayer(r)&&o.addLayer(r),$.ajax({url:"libs/php/getCountryFlag.php",type:"POST",dataType:"json",data:{countryCode:t.data.results[0].components.country_code.toUpperCase()},success:function(t){JSON.stringify(t);let n=`<img class="flag" src=${t.data.flag} />`;if("ok"==t.status.name){L.popup().setLatLng([a,e]).setContent(n).openOn(o)}},error:function(t,a,e){}}))}})},error:function(t,a,e){}})}),$("#userCoronaInfo").click(function(){$.ajax({url:"libs/php/getOpenCage.php",type:"POST",dataType:"json",data:{q:String(a)+","+String(e)},success:function(t){"ok"==t.status.name&&$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(s){if(JSON.stringify(s),"ok"==s.status.name)for(let d=0;d<s.data.length;d++)s.data[d].properties.iso_a2===t.data.results[0].components.country_code.toUpperCase()&&(o.removeLayer(n),o.setView([a,e],13),o.removeLayer(r)&&o.addLayer(r),$.ajax({url:"libs/php/getCoronaInfo.php",type:"POST",dataType:"json",data:{countryCode:t.data.results[0].components.country_code},success:function(t){if("ok"==t.status.name){L.popup().setLatLng([a,e]).setContent("Updated at: "+t.data.data.updated_at+"<br>Deaths today: "+t.data.data.today.deaths+"<br>Deaths confirmed today: "+t.data.data.today.confirmed+"<br>Latest deaths: "+t.data.data.latest_data.deaths+"<br>Latest deaths confirmed: "+t.data.data.latest_data.confirmed+"<br>Recovered: "+t.data.data.latest_data.recovered+"<br>Critical: "+t.data.data.latest_data.critical+"<br>Calculated death rate: "+t.data.data.latest_data.calculated.death_rate+"<br>Calculated recovery rate: "+t.data.data.latest_data.calculated.recovery_rate+"<br>Calculated cases per miliion population: "+t.data.data.latest_data.calculated.cases_per_million_population).openOn(o)}},error:function(t,a,e){}}))}})},error:function(t,a,e){}})}),$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:"{}",success:function(t){if(JSON.stringify(t),"ok"==t.status.name)for(let a=0;a<t.data.length;a++)$("#selectCountry").append(`<option value = "${t.data[a].properties.iso_a2}">`+t.data[a].properties.name+"</option>"),$("#selectCountryInfo").click(function(){$("#selectCountry").val()===t.data[a].properties.iso_a2&&(o.removeLayer(n),o.removeLayer(r),n=L.geoJson(t.data[a].geometry),n.addTo(o),o.fitBounds(n.getBounds()),$.ajax({url:"libs/php/getCountryInfo.php",type:"POST",dataType:"json",data:{countryCode:$("#selectCountry").val()},success:function(t){if(JSON.stringify(t),"ok"==t.status.name){let a=n.getBounds().getCenter();L.popup().setLatLng(a).setContent("Capital: "+t.data[0].capital+"<br>Continent: "+t.data[0].continent+"<br>Continent name: "+t.data[0].continentName+"<br>Country name: "+t.data[0].countryName+"<br>Currency code: "+t.data[0].currencyCode+"<br>Languages: "+t.data[0].languages+"<br>North: "+t.data[0].north+"<br>East: "+t.data[0].east+"<br>South: "+t.data[0].south+"<br>West: "+t.data[0].west+"<br>Population: "+t.data[0].population).openOn(o)}}}))}),$("#selectHolidayInfo").click(function(){$("#selectCountry").val()===t.data[a].properties.iso_a2&&(o.removeLayer(n),o.removeLayer(r),n=L.geoJson(t.data[a].geometry),n.addTo(o),o.fitBounds(n.getBounds()),$.ajax({url:"libs/php/getHolidayInfo.php",type:"POST",dataType:"json",data:{countryCode:$("#selectCountry").val()},success:function(t){if(JSON.stringify(t),"ok"==t.status.name){function a(){let a=[];for(let e=0;e<t.data.length;e++){let o=t.data[e].date+" "+t.data[e].localName;a.push(o)}return a}let e=a().join(" <br>"),s=n.getBounds().getCenter();L.popup().setLatLng(s).setContent(e).openOn(o)}}}))}),$("#selectIncomeInfo").click(function(){$("#selectCountry").val()===t.data[a].properties.iso_a2&&(o.removeLayer(n),o.removeLayer(r),n=L.geoJson(t.data[a].geometry),n.addTo(o),o.fitBounds(n.getBounds()),$.ajax({url:"libs/php/getIncomeInfo.php",type:"POST",dataType:"json",data:{countryCode:$("#selectCountry").val()},success:function(t){if(JSON.stringify(t),"ok"==t.status.name){let a=n.getBounds().getCenter();L.popup().setLatLng(a).setContent("Income level: "+t.data[1][0].incomeLevel.value).openOn(o)}}}))}),$("#selectFlag").click(function(){$("#selectCountry").val()===t.data[a].properties.iso_a2&&(o.removeLayer(n),o.removeLayer(r),n=L.geoJson(t.data[a].geometry),n.addTo(o),o.fitBounds(n.getBounds()),$.ajax({url:"libs/php/getCountryFlag.php",type:"POST",dataType:"json",data:{countryCode:$("#selectCountry").val()},success:function(t){if(JSON.stringify(t),"ok"==t.status.name){let a=n.getBounds().getCenter(),e=`<img class="flag" src=${t.data.flag} />`;L.popup().setLatLng(a).setContent(e).openOn(o)}}}))}),$("#selectCoronaInfo").click(function(){$("#selectCountry").val()===t.data[a].properties.iso_a2&&(o.removeLayer(n),o.removeLayer(r),n=L.geoJson(t.data[a].geometry),n.addTo(o),o.fitBounds(n.getBounds()),$.ajax({url:"libs/php/getCoronaInfo.php",type:"POST",dataType:"json",data:{countryCode:$("#selectCountry").val()},success:function(t){if(JSON.stringify(t),"ok"==t.status.name){let a=n.getBounds().getCenter();L.popup().setLatLng(a).setContent("Updated at: "+t.data.data.updated_at+"<br>Deaths today: "+t.data.data.today.deaths+"<br>Confirmed today: "+t.data.data.today.confirmed+"<br>Deaths: "+t.data.data.latest_data.deaths+"<br>Confirmed deaths: "+t.data.data.latest_data.confirmed+"<br>Recovered: "+t.data.data.latest_data.recovered+"<br>Critical: "+t.data.data.latest_data.critical+"<br>Calculated death rate: "+t.data.data.latest_data.calculated.death_rate+"<br>Calculated recovery rate: "+t.data.data.latest_data.calculated.death_rate+"<br>Calculated cases per million population: "+t.data.data.latest_data.calculated.cases_per_million_population).openOn(o)}}}))})}})})});